{"remainingRequest":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\src\\views\\category\\Category.vue?vue&type=style&index=0&id=1a0c5ce5&scoped=true&lang=css&","dependencies":[{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\src\\views\\category\\Category.vue","mtime":1641122040969},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\css-loader\\index.js","mtime":1636441675622},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1636441705188},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\postcss-loader\\src\\index.js","mtime":1636441711061},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636441690295},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":1636441705177}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#category{\n  height: 100vh;\n}\n\n.nav-bar{\n  background-color: var(--color-tint);\n  font-weight: 700;\n  color: #fff;\n}\n\n.content{\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 44px;\n  bottom: 49px;\n  display: flex;\n}\n\n#tab-content{\n  height: 100%;\n  flex: 1;\n}\n",{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/category","sourcesContent":["<template>\n  <div class=\"category\">\n    <nav-bar class=\"nav-bar\"><div slot=\"center\">商品分类</div></nav-bar>\n    <div class=\"content\">\n      <tab-menu :categories=\"categories\"\n                @selectItem=\"selectItem\">\n      </tab-menu>\n      <scroll id=\"tab-content\"\n              :data=\"[categoryData]\"\n              ref=\"scroll\">\n          <div>\n            <tab-content-category :subcategories=\"showSubcategory\"></tab-content-category>\n            <tab-control :titles=\"['综合','新品','销量']\"\n                          @itemClick=\"tabClick\">\n            </tab-control>\n            <goods-list :goods=\"showCategoryDetail\"></goods-list>\n          </div>\n      </scroll>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBar from '../../components/common/navbar/NavBar.vue'\n\nimport TabMenu from './childComps/TabMenu.vue'\nimport TabContentCategory from './childComps/TabContentCategory.vue'\n\nimport TabControl from 'components/content/tabControl/TabControl'\nimport Scroll from 'components/common/srcoll/Scroll'\nimport GoodsList from 'components/content/goods/GoodsList'\n\nimport {getCategory,getSubcategory,getCategoryDetail} from 'network/category'\nimport {POP,SELL,NEW } from 'common/const'\nimport {tabControlMixin} from '@/common/mixin'\n\n  export default {\n    name: \"Category\",\n    components: {\n      NavBar,\n      TabMenu,\n      TabControl,\n      Scroll,\n      TabContentCategory,\n      GoodsList\n    },\n    mixins:[tabControlMixin],\n    data(){\n      return {\n        categories: [],\n        categoryData:{},\n        currentIndex: -1\n      }\n    },\n    created(){\n      // 请求分类数据\n      this._getCategory()\n\n      // 监听图片加载完成\n      this.$bus.$on('imgLoad',() => {\n        this.$refs.scroll.refresh()\n      })\n    },\n    computed: {\n      showSubcategory(){\n        if (this.currentIndex === -1) return {}\n        return this.categoryData[this.currentIndex].subcategories\n      },\n      showCategoryDetail(){\n        if (this.currentIndex === -1) return []\n        return this.categoryData[this.currentIndex].categoryDetail[this.currentType]\n      }\n    },\n    methods: {\n      _getCategory(){\n        getCategory().then(res => {\n          // 获取分类数据\n          this.categories = res.data.category.list\n          console.log(res);\n          // 初始化每个类别的子数据\n          for (let i = 0; i < this.categories.length; i++) {\n            this.categoryData[i] = {\n              subcategories: {},\n              categoryDetail: {\n                'pop': [],\n                'new': [],\n                'sell': [],\n              }\n            }\n          }\n          // 请求第一个分类的数据\n          this._getSubcategories(0)\n        })\n      },\n      _getSubcategories(index){\n        this.currentIndex = index;\n        const mailKey = this.categories[index].maitKey;\n        getSubcategory(mailKey).then(res => {\n          this.categoryData[index].subcategories = res.data\n          this.categoryData = {...this.categoryData}\n          this._getCategoryDetail(POP)\n          this._getCategoryDetail(SELL)\n          this._getCategoryDetail(NEW)\n        })\n      },\n      _getCategoryDetail(type){\n        // 获取请求的miniWallkey\n        const miniWallkey = this.categories[this.currentIndex].miniWallkey;\n        // 发送请求,传入mininWallkey和type\n        getCategoryDetail(miniWallkey,type).then(res => {\n          // 将获取的数据保存下来\n          this.categoryData[this.currentIndex].categoryDetail[type] =res\n          this.categoryData = {...this.categoryData}\n        })\n      },\n      // 事件相应相关的方法\n      selectItem(index){\n        this._getSubcategories(index)\n      }\n    }\n  }\n</script>\n\n<style scoped>\n  #category{\n    height: 100vh;\n  }\n\n  .nav-bar{\n    background-color: var(--color-tint);\n    font-weight: 700;\n    color: #fff;\n  }\n\n  .content{\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 44px;\n    bottom: 49px;\n    display: flex;\n  }\n\n  #tab-content{\n    height: 100%;\n    flex: 1;\n  }\n</style>\n"]}]}