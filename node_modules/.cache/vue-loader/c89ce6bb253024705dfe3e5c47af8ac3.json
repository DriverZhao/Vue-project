{"remainingRequest":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\src\\views\\detail\\Detail.vue?vue&type=style&index=0&id=117d0e76&scoped=true&lang=css&","dependencies":[{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\src\\views\\detail\\Detail.vue","mtime":1640084773425},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\css-loader\\index.js","mtime":1636441675622},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1636441705188},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\postcss-loader\\src\\index.js","mtime":1636441711061},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1636441690295},{"path":"E:\\xiaohong-working\\html5&css3\\vue-project\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":1636441705177}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#detail{\n    position: relative;\n    z-index: 9;\n    background-color: #fff;\n}\n.content{\n    height: calc(100% - 44px);\n}\n",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\r\n    <div id=\"detail\">\r\n        <detail-nav-bar @titleClick=\"selectIndex\" :current-index=\"currentIndex\"></detail-nav-bar>\r\n        <scroll class=\"content\" \r\n                ref=\"scroll\"\r\n                @scroll=\"contentScroll\"\r\n                :prode-type=\"3\"\r\n                :data=\"[topImages,goods,shop,detailInfo,paramInfo,goodsList]\">\r\n            <detail-swiper :top-images=\"topImages\"/>\r\n            <detail-base-info :goods=\"goods\"></detail-base-info>\r\n            <detail-shop-info :shop=\"shop\"></detail-shop-info>\r\n            <detail-goods-info :deatil-info=\"detailInfo\" @imageLoad=\"imageLoad\"></detail-goods-info>\r\n            <detail-param-info ref=\"param\" :param-info=\"paramInfo\"></detail-param-info>\r\n            <detail-comment-info ref=\"comment\" :comment-info=\"commentInfo\"></detail-comment-info>\r\n            <goods-list ref=\"recommend\" :goods=\"goodsList\"/>\r\n        </scroll>\r\n        <back-top v-show=\"showBackTop\" @click.native=\"backTop\"/>\r\n        <detail-bottom-bar @addToCart=\"addToCart\"/>\r\n        <toast ref=\"toast\"/>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport DetailNavBar from './childComps/DetailNavBar.vue'\r\nimport DetailSwiper from './childComps/DetailSwiper.vue'\r\nimport DetailBaseInfo from './childComps/DetailBaseInfo.vue'\r\nimport DetailShopInfo from './childComps/DetailShopInfo.vue'\r\nimport DetailGoodsInfo from './childComps/DetailGoodsInfo.vue'\r\nimport DetailParamInfo from './childComps/DetailParamInfo.vue'\r\nimport DetailCommentInfo from './childComps/DetailCommentInfo.vue'\r\nimport DetailBottomBar from './childComps/DetaBottomBar.vue'\r\nimport CartButton from './childComps/CartButton.vue'\r\n\r\nimport Scroll from 'components/common/srcoll/Scroll'\r\n\r\nimport {getDetail,getRecommend,Goods,Shop,GoodsParam} from 'network/detail'\r\nimport {backTopMixin} from 'common/mixin'\r\nimport {mapActions} from 'vuex'\r\n\r\nimport Toast from 'components/common/toast/Toats'\r\nimport GoodsList from 'components/content/goods/GoodsList.vue'\r\n\r\nexport default {\r\n    name: \"Detail\",\r\n    components: {\r\n        DetailNavBar,\r\n        DetailSwiper,\r\n        DetailBaseInfo,\r\n        DetailShopInfo,\r\n        DetailGoodsInfo,\r\n        DetailParamInfo,\r\n        DetailCommentInfo,\r\n        CartButton,\r\n        GoodsList,\r\n        DetailBottomBar,\r\n        Scroll,\r\n        Toast,\r\n    },\r\n    mixins: [backTopMixin],\r\n    data(){\r\n        return {\r\n            iid: '',\r\n            topImage: [],\r\n            goods: {},\r\n            shop: {},\r\n            detailInfo: {},\r\n            paramInfo: {},\r\n            commentInfo: {},\r\n            goodsList: [],\r\n            themeTops: [],\r\n            currentIndex: 0\r\n        }\r\n    },\r\n    created(){\r\n        // 去除iid\r\n        this.iid = this.$router.params.iid\r\n\r\n        getDetail(this.iid).then(res => {\r\n            console.log(res);\r\n            const data = res.result;\r\n            this.topImage = data.itemInfo.topImages;\r\n\r\n            this.goods = new Goods(data.itemInfo,data.columns,data.shopInfo.services);\r\n\r\n            this.shop = new Shop(data.shopInfo);\r\n\r\n            this.detailInfo = data.detailInfo;\r\n\r\n            this.paramInfo = new GodosParam(data.itemParams.info , data.itemParams.rule);\r\n        })\r\n    },\r\n    methods: {\r\n        ...mapActions({\r\n            addCart: 'addToCart'\r\n        }),\r\n        imageLoad(){\r\n            this.$refs.scroll.refresh();\r\n            // 获取对应的offsetTop\r\n            this.themeTops = [];\r\n            this.themeTops.push(0);\r\n            this.themeTops.push(this.$refs.param.$el.offsetTop);\r\n            this.themeTops.push(this.$refs.comment.$el.offsetTop);\r\n            this.themeTops.push(this.$refs.recommend.$el.offsetTop);\r\n            this.themeTops.push(Number.MAX_VALUE);\r\n        },\r\n        selectIndex(index){\r\n            this.$refs.scroll.scrollTo(0,-this.themeTops[index],500);\r\n        },\r\n        contentScroll(position){\r\n            // 决定backTop按钮是否显示\r\n            this.showBackTop = position.y <= -1000;\r\n            // 监听滚动到某个主题\r\n            this._listenScrollTheme(-position.y);\r\n        },\r\n        _listenScrollTheme(position){\r\n            let length = this.themeTops.length\r\n            for (let i = 0; i < length; i++) {\r\n                let iPos = this.themeTops[i];\r\n\r\n                if (position >= iPos && position < this.themeTops[i+1]) {\r\n                    if (this.currentIndex !== i) {\r\n                        this.currentIndex = i;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        cartClick(){\r\n            this.$router.push('/cart');\r\n        },\r\n        addTopCart(){\r\n            // 将商品添加到Store中\r\n            const obj = {};\r\n            obj.iid = this.iid;\r\n            obj.imgURL = this.topImages[0];\r\n            obj.title = this.goods.title;\r\n            obj.desc = this.goods.desc;\r\n            obj.price = this.goods.realPrice;\r\n\r\n            this.addCart(obj).then(() => {\r\n                this.$toast({message: '加入购物车成功！'});\r\n            })\r\n        },\r\n        _getDetail(iid){\r\n            getDetail(iid).then(res => {\r\n                // 获取数据\r\n                const data = res.result;\r\n                console.log(data);\r\n\r\n                // 获取顶部的图片数据\r\n                this.topImages = data.itemInfo.topImages;\r\n\r\n                // 获取商品信息\r\n                this.goods = new Goods(data.itemInfo,data.columns,data.shopInfo.services);\r\n\r\n                // 获取店铺信息\r\n                this.shop = new Shop(data.shopInfo);\r\n\r\n                // 获取商品详细信息\r\n                this.detailInfo = data.detailInfo\r\n\r\n                // 保存参数信息\r\n                this.paramInfo = new GodosParam(data.itemParams.info,data.itemParams.rule);\r\n\r\n                // 保存评论数据\r\n                if (data.rate.list) {\r\n                    this.commentInfo = data.rate.list[0];\r\n                }\r\n            })\r\n        },\r\n        _getRecommend(){\r\n            getRecommend().then(res => {\r\n                this.goodsList = res.data.list\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n    #detail{\r\n        position: relative;\r\n        z-index: 9;\r\n        background-color: #fff;\r\n    }\r\n    .content{\r\n        height: calc(100% - 44px);\r\n    }\r\n</style>"]}]}